<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Waypoint App</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html {
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: transparent;
    }

    .window {
      position: absolute;
      top: 50px;
      left: 50px;
      width: 300px; /* Width of the entire window */
      height: 300px;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      padding: 10px;
      display: flex;
      flex-direction: row; /* Change to row to allow side-by-side */
      overflow: hidden;
      user-select: none;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 5px;
      border-radius: 10px;
      cursor: move;
    }

    #closeBtn {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
    }

    .buttons {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      height: 100%;
      width: 150px; /* Width of the job menu */
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 5px;
      padding: 5px;
    }

    button {
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 8px;
      margin-bottom: 5px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: rgba(0, 0, 0, 0.7);
    }

    .locationMenu {
      display: none; /* Initially hidden */
      margin-left: 10px;
      flex-grow: 1; /* This will take remaining space */
      background-color: rgba(0, 0, 255, 0.5);
      border-radius: 10px;
      padding: 10px;
    }

    .locationMenu button {
      background-color: rgba(0, 0, 255, 0.7);
      margin-bottom: 5px;
    }
  </style>
</head>
<body>
  <div id="app" class="window">
    <div id="header" class="header">
      <span>Waypoint App</span>
      <button id="closeBtn">X</button>
    </div>
    <div id="content" style="display: flex; width: 100%; height: 100%">
      <!-- Left Side: Job Buttons -->
      <div id="jobButtons" class="buttons"></div>

      <!-- Right Side: Location Menu (initially hidden) -->
      <div id="locationButtons" class="locationMenu"></div>
    </div>
  </div>

  <script>
    const jobButtons = document.getElementById('jobButtons');
    const locationButtons = document.getElementById('locationButtons');
    const closeBtn = document.getElementById('closeBtn');
    let jobs = [
      "Aerial Firefighter", "Airline Pilot", "Beach Cleaner", "Bus Driver", "Business", 
      "Cargo Pilot", "Coast Guard", "CollinsCo Cabbies", "Dock Handler", "EMS", "Farming", 
      "Firefighter", "Fishing", "Garbage Collector", "Heli Pilot", "Hunter", "IAA Delivery", 
      "Land Survey", "Mechanic", "Miner", "Parking Officer", "PostOp", "Pizza Delivery", 
      "Quarry", "RTS", "Server Repair", "Street Racing", "Train Conductor", 
      "Transformer Repair", "Trucking", "Courier"
    ];

    let locations = {}; // Placeholder for job locations

    // Example function to load location buttons from a JSON file based on job selection
    const loadLocations = async (job) => {
      const data = await fetch('locations.json').then(response => response.json());

      if (data[job]) {
        locationButtons.innerHTML = ''; // Clear any existing location buttons
        data[job].forEach(location => {
          const btn = document.createElement('button');
          btn.innerText = `Set waypoint to ${location.name}`;
          btn.onclick = () => setWaypoint(location.x, location.y);
          locationButtons.appendChild(btn);
        });
      }
    };

    // Create job buttons
    jobs.forEach(job => {
      const jobButton = document.createElement('button');
      jobButton.innerText = job;
      jobButton.onclick = () => {
        locationButtons.style.display = 'flex'; // Show location buttons
        loadLocations(job); // Load locations for the selected job
      };
      jobButtons.appendChild(jobButton);
    });

    // Function to set the waypoint
    const setWaypoint = (x, y) => {
      const command = { type: 'setWaypoint', x: x, y: y };
      console.log(command); // Send this command to the game
    };

    // Close button functionality
    closeBtn.onclick = () => {
      window.close(); // This will close the window (not supported on all browsers)
    };

    // Make the window draggable
    const header = document.getElementById('header');
    let isDragging = false;
    let offsetX, offsetY;

    header.onmousedown = (e) => {
      isDragging = true;
      offsetX = e.clientX - window.screenX;
      offsetY = e.clientY - window.screenY;
    };

    document.onmousemove = (e) => {
      if (isDragging) {
        window.moveTo(e.clientX - offsetX, e.clientY - offsetY);
      }
    };

    document.onmouseup = () => {
      isDragging = false;
    };

    // Implement custom scrolling with middle mouse wheel
    let scrollPosition = 0;

    window.onwheel = (e) => {
      if (e.button === 1) { // Only use middle mouse button (wheel)
        e.preventDefault(); // Prevent the default scroll behavior
        scrollPosition += e.deltaY;
        locationButtons.scrollTop = scrollPosition; // Scroll the container manually
      }
    };
  </script>
</body>
</html>
