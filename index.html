<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Waypoint App</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html {
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: transparent;
    }

    .window {
      position: absolute;
      top: 50px;
      left: 50px;
      width: 250px;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      padding: 10px;
      overflow: hidden;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 5px;
      border-radius: 10px;
    }

    #closeBtn {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
    }

    .buttons {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
    }

    button {
      background: rgba(0, 0, 0, 0.3);
      color: white;
      padding: 8px;
      margin-bottom: 5px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: rgba(0, 0, 0, 0.5);
    }

    #jobButtons {
      display: flex;
      flex-direction: column;
    }

    #locationButtons {
      display: none;
      flex-direction: column;
    }

    #locationButtons button {
      background-color: rgba(0, 0, 255, 0.6);
    }
  </style>
</head>
<body>
  <div id="app" class="window">
    <div id="header" class="header">
      <span>Waypoint App</span>
      <button id="closeBtn">X</button>
    </div>
    <div id="content">
      <div id="jobButtons" class="buttons"></div>
      <div id="locationButtons" class="buttons"></div>
    </div>
  </div>

  <script>
    const jobButtons = document.getElementById('jobButtons');
    const locationButtons = document.getElementById('locationButtons');
    const closeBtn = document.getElementById('closeBtn');
    let jobs = [
      "Aerial Firefighter", "Airline Pilot", "Beach Cleaner", "Bus Driver", "Business", 
      "Cargo Pilot", "Coast Guard", "CollinsCo Cabbies", "Dock Handler", "EMS", "Farming", 
      "Firefighter", "Fishing", "Garbage Collector", "Heli Pilot", "Hunter", "IAA Delivery", 
      "Land Survey", "Mechanic", "Miner", "Parking Officer", "PostOp", "Pizza Delivery", 
      "Quarry", "RTS", "Server Repair", "Street Racing", "Train Conductor", 
      "Transformer Repair", "Trucking", "Courier"
    ];

    let locations = {}; 


    const loadLocations = async (job) => {
      const data = await fetch('locations.json').then(response => response.json());

      if (data[job]) {
        locationButtons.innerHTML = '';
        data[job].forEach(location => {
          const btn = document.createElement('button');
          btn.innerText = `Set waypoint to ${location.name}`;
          btn.onclick = () => setWaypoint(location.x, location.y);
          locationButtons.appendChild(btn);
        });
      }
    };

    // Create job buttons
    jobs.forEach(job => {
      const jobButton = document.createElement('button');
      jobButton.innerText = job;
      jobButton.onclick = () => {
        locationButtons.style.display = 'flex'; 
        loadLocations(job); 
      };
      jobButtons.appendChild(jobButton);
    });

    // Function to set the waypoint
    const setWaypoint = (x, y) => {
      const command = { type: 'setWaypoint', x: x, y: y };
      console.log(command); 
    };


    closeBtn.onclick = () => {
      window.close(); 
    };

    // Make the window draggable
    const header = document.getElementById('header');
    let isDragging = false;
    let offsetX, offsetY;

    header.onmousedown = (e) => {
      isDragging = true;
      offsetX = e.clientX - window.screenX;
      offsetY = e.clientY - window.screenY;
    };

    document.onmousemove = (e) => {
      if (isDragging) {
        window.moveTo(e.clientX - offsetX, e.clientY - offsetY);
      }
    };

    document.onmouseup = () => {
      isDragging = false;
    };
  </script>
</body>
</html>
