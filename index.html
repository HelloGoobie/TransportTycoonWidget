<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Locations</title>
    <style>
        /* Base styles */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: transparent;
            overflow: hidden;
        }

        #menu {
            position: fixed;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            background: #1e293b;
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            width: 200px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1000;
        }

        #menu h3 {
            margin: 0 0 10px;
        }

        #menu select {
            margin-bottom: 15px;
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: none;
            outline: none;
            background: #64748b;
            color: white;
        }

        #menu button {
            padding: 10px 15px;
            background: #3b82f6;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        #menu button:hover {
            background: #2563eb;
        }

        #shelf {
            position: fixed;
            top: 0;
            right: 0;
            height: 100%;
            width: 300px;
            background: #1e293b;
            color: white;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2);
            overflow-y: auto;
            transition: transform 0.4s ease, opacity 0.4s ease;
            padding: 20px;
            z-index: 1000;
            transform: translateX(100%); /* Start off-screen */
            opacity: 0; /* Fully transparent */
        }

        #shelf.open {
            transform: translateX(0); /* Slide into view */
            opacity: 1; /* Fully visible */
        }

        #shelf h3 {
            margin: 0 0 15px;
        }

        #shelf ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #shelf ul li {
            padding: 10px 15px;
            margin-bottom: 10px;
            background: #64748b;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        #shelf ul li:hover {
            background: #3b82f6;
        }

        .moveable {
            cursor: grab;
        }
    </style>
</head>
<body>
    <div id="menu" class="moveable">
        <h3>Job Selector</h3>
        <select id="jobSelect">
            <option value="" disabled selected>Select a job</option>
        </select>
        <button id="viewLocations">View Locations</button>
    </div>

    <div id="shelf">
        <h3 id="shelfTitle">Locations</h3>
        <ul id="locationList"></ul>
    </div>

    <script>
        // Embedded locations data
        const locations = {
            "Aerial Firefighter": [
          { "name": "Location 1", "x": 500, "y": 250 },
          { "name": "Location 2", "x": 1000, "y": 500 }
            ],
            "Airline Pilot": [
          { "name": "Airport Runway", "x": 1500, "y": 1000 },
          { "name": "Sky Location 1", "x": 2000, "y": 1200 }
            ],
            "Beach Cleaner": [
          { "name": "Beach Location 1", "x": 100, "y": 200 },
          { "name": "Beach Location 2", "x": 300, "y": 400 }
            ],
            "Business": [
          { "name": "Wenger Institute", "x": -368.79766845703, "y": -240.53649902344, "z": 36.080070495605 },
          { "name": "La Vaca Loco", "x": 142.927383, "y": -1520.104736, "z": 29.836950 },
          { "name": "Vespucci Movie Masks", "x": -1337.976440, "y": -1276.094116, "z": 4.895197 },
          { "name": "Mr. Spoke's Bike Rental", "x": -1106.429565, "y": -1695.158203, "z": 4.373420 },
          { "name": "Sandy Shores Liquor", "x": 1952.636353, "y": 3842.005371, "z": 32.178314 }
            ]
        };

        const jobSelect = document.getElementById("jobSelect");
        const viewLocationsButton = document.getElementById("viewLocations");
        const shelf = document.getElementById("shelf");
        const shelfTitle = document.getElementById("shelfTitle");
        const locationList = document.getElementById("locationList");

        // Populate job dropdown
        for (const job in locations) {
            const option = document.createElement("option");
            option.value = job;
            option.textContent = job;
            jobSelect.appendChild(option);
        }

        // Open the shelf with locations
        viewLocationsButton.addEventListener("click", () => {
            const selectedJob = jobSelect.value;
            if (!selectedJob) return alert("Please select a job!");

            // Populate shelf with locations
            shelfTitle.textContent = `${selectedJob} Locations`;
            locationList.innerHTML = ""; // Clear previous options

            locations[selectedJob].forEach(location => {
                const li = document.createElement("li");
                li.textContent = location.name;
                li.addEventListener("click", () => {
                    const { x, y } = location;
                    window.parent.postMessage({ type: "setWaypoint", x, y }, "*");
                    console.log(`Waypoint set to: X=${x}, Y=${y}`);
                    simulateF1KeyPress();
                });
                locationList.appendChild(li);
            });

            // Slide the shelf in and make it visible
            shelf.classList.add("open");
        });

        // Close the shelf by clicking anywhere outside
        document.addEventListener("click", (e) => {
            if (!shelf.contains(e.target) && !viewLocationsButton.contains(e.target)) {
                shelf.classList.remove("open");
            }
        });

        // Simulate F1 key press
        function simulateF1KeyPress() {
            const event = new KeyboardEvent("keydown", { key: "F1" });
            document.dispatchEvent(event);
        }

        // Make the menu movable
        const menu = document.getElementById("menu");
        let isDragging = false;
        let offsetX, offsetY;

        menu.addEventListener("mousedown", (e) => {
            isDragging = true;
            offsetX = e.clientX - menu.offsetLeft;
            offsetY = e.clientY - menu.offsetTop;
            menu.style.cursor = "grabbing";
        });

        document.addEventListener("mousemove", (e) => {
            if (isDragging) {
                menu.style.left = `${e.clientX - offsetX}px`;
                menu.style.top = `${e.clientY - offsetY}px`;
            }
        });

        document.addEventListener("mouseup", () => {
            isDragging = false;
            menu.style.cursor = "grab";
        });
    </script>
</body>
</html>
